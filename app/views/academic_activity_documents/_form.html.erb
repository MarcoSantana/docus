  <div class="card text-center">

    <div class="card-block ">
      <%= form_for(@academic_activity_document, layout: :basic)  do |f| %>
          <% if @academic_activity_document.errors.any? %>
              <div class="alert alert-danger" role="alert" id="errors">
                <h4><%= pluralize(@academic_activity_document.errors.count, 'error') %> evitó crear este documento:</h4>
                <ul class="list-group-warning">
                  <% @academic_activity_document.errors.full_messages.each do |message| %>
                      <li class="list-group-item"><%= message %></li>
                  <% end %>
                </ul>
              </div>
          <% end %>
          <%= image_tag @academic_activity_document.image.url, class: 'card-img-top img-fluid img-center p-a-3' %>
          <fieldset class="form-group">
            <%= f.select(:description, AcademicActivityDocument.descriptions.keys.map {|description| [description.titleize,description]}, label: 'Descripción del documento', class: 'form-control', include_blank: true ) %>
            <%= label :issuer, 'Emisor del documento' %>
            <%= collection_select :issuer, :issuer_ids,  Issuer.all, :id, :name,  {include_blank: true},{class: 'form-control', label: 'Emisor'} %>

            <% if current_user.role < 'aspirante' %>
                <%= f.select(:status, AcademicActivityDocument.statuses.keys.map {|status| [status.titleize,status]}, class: 'form-control', include_blank: true ) %>
                <%= f.text_area :comentary, class: 'form-control' %>
            <% end %>
          </fieldset>

          <% if @academic_activity_document.errors[:to].present? || @academic_activity_document.errors[:from].present? %>
            <% field_class = "text-danger" %>
          <% end %>

          <fieldset class="form-group">
            <div class="form-group <%= field_class %>" id="dates">
              <div class="">
                <%= label_tag :dates, 'Fechas de actividad', class: "control-label #{field_class}" %>
                <div class="card-group text-center">
                <div class="col-md-6 <%= field_class %>">
                  <%= label :to, 'Desde', class: "form-control" %>
                  <%= f.date_select :from, {include_blank: false, prompt: { day: 'Seleccione día de inicio', month: 'Seleccione mes de inicio', year: 'Seleccione año de inicio'}, start_year: 1920, end_year: Time.now.year }, {class: "form-control"}%>
                  </div>
                  <div class="col-md-6">
                    <%= label :to, 'Hasta', class: "form-control" %>
                    <%= f.date_select :to, {include_blank: false, prompt: { day: 'Seleccione día de fin', month: 'Seleccione mes de fin', year: 'Seleccione año de fin'}, start_year: 1920, end_year: Time.now.year }, {class: "form-control"} %>
                  </div>
              </div>
              </div>
            </div>
          </fieldset>
          <%= f.file_field :image, :onchange => 'previewFile()', placeholder: 'Elegir imagen', class: 'form-control', label:'Imagen' %>
          <div class="actions">
            <%= button_tag( class: 'btn btn-success') do %>
                <p class="hidden-md-down">Guardar</p><i class="material-icons hidden-sm-up">save</i>
            <% end %>
          </div>


      <% end %>

  </div>




<script language="JavaScript">
  function previewFile() {
    var preview = document.querySelector('img');
    var file    = document.querySelector('input[type=file]').files[0];
    var reader  = new FileReader();

    reader.onloadend = function () {
      preview.src = reader.result;
    }

    if (file) {
      reader.readAsDataURL(file);
    } else {
      preview.src = "";
    }
  }
  $(window).on("beforeunload", function() {
      return "Are you sure? You didn't finish the form!";
  });

  $(document).ready(function() {
      $("#myForm").on("submit", function(e) {
          //check form to make sure it is kosher
          //remove the ev
          $(window).off("beforeunload");
          return true;
      });
  });
</script>
